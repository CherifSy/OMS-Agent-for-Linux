require 'json'
require 'securerandom' # SecureRandom.uuid 

require_relative 'collectmcafeeinfo'
require_relative 'antimalwarecommon'

ret = {}
if McAfee.detect()
    ret = McAfee.getprotectionstatus()
else
    ($ProtectionRank, $ProtectionStatus) = AntimalwareCommon::UnknownProtectionCode
    ($ThreatStatusRank, $ThreatStatus) = AntimalwareCommon::UnknownThreatCode
	ret["ProtectionRank"] = $ProtectionRank
    ret["ProtectionStatus"] = $ProtectionStatus
    ret["ProtectionStatusDetails"] = ""
    ret["DetectionId"] = SecureRandom.uuid
    ret["Threat"] = ""
    ret["ThreatStatusRank"] = $ThreatStatusRank
    ret["ThreatStatus"] = $ThreatStatus
	ret["ThreatStatusDetails"] = ""
	ret["Signature"] = ""
    ret["ScanDate"] = DateTime.now.strftime("%d/%m/%Y %H:%M")
    ret["DateCollected"] = DateTime.now.strftime("%d/%m/%Y %H:%M")
    ret["ToolName"] = "No Anti-Malware Tool was detected"
    ret["AMProductVersion"] = ""
end
puts ret
return ret